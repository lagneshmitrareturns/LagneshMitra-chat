<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>LagneshMitra – Shaping the Future</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" href="style.css">

<style>
/* ---------- TOP BAR ---------- */
.topbar{
  position:fixed;
  top:0;left:0;width:100%;
  height:70px;
  padding:16px 22px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  z-index:500;
}

.brand{
  font-size:22px;
  font-style:italic;
  font-weight:600;
  color:#ff5da2;
}
.brand span{
  display:block;
  font-size:12px;
  color:#d8b4fe;
}

/* ---------- MENU ---------- */
.menu{
  font-size:26px;
  cursor:pointer;
  color:#e9d5ff;
}

/* ---------- DROPDOWN (IDEOLOGY PANEL) ---------- */
.dropdown{
  position:absolute;
  top:70px;
  right:22px;
  width:340px;
  padding:18px;
  display:none;
  z-index:999;
}

.dropdown h4{
  font-size:13px;
  opacity:.7;
  margin-bottom:6px;
}

.dropdown p{
  font-size:14px;
  margin-bottom:6px;
}

.dropdown a{
  display:block;
  margin-top:6px;
  color:#ff5da2;
  text-decoration:none;
}

/* ---------- HERO ---------- */
.hero{
  min-height:calc(100vh - 160px);
  margin-top:70px;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:40px;
}

/* ---------- POST CARD ---------- */
.post-card{
  max-width:720px;
  padding:26px;
  border-radius:22px;
  cursor:pointer;
}

.post-card h3{
  color:#ff5da2;
  font-style:italic;
  margin-bottom:6px;
}

.meta{
  font-size:12px;
  color:#c4b5fd;
  margin-bottom:14px;
}

.post-preview,.post-full{
  font-size:18px;
  line-height:1.75;
  color:#e9d5ff;
}
.post-full{display:none}

.read-more{
  margin-top:14px;
  font-size:13px;
  color:#ff5da2;
  font-style:italic;
}

/* ---------- ZENO CLOUD ---------- */
#zeno-cloud{
  position:fixed;
  right:20px;
  bottom:90px;
  width:280px;
  padding:16px;
  font-size:14px;
  display:none;
  z-index:998;
}
</style>
</head>

<body>

<!-- TOP BAR -->
<div class="topbar">
  <div class="brand">
    LagneshMitra
    <span>Decision Intelligence</span>
  </div>
  <div class="menu" onclick="toggleMenu()">⋮</div>

  <!-- IDEOLOGY DROPDOWN -->
  <div class="dropdown glass" id="menuBox">
    <h4>Core Thinking</h4>
    <p>We do not predict.</p>
    <p>We interpret.</p>
    <p>Decisions before remedies.</p>

    <h4>This Platform Is</h4>
    <p>Structured Vedic analysis</p>
    <p>Psychology-aware readings</p>

    <h4>This Platform Is Not</h4>
    <p>No daily horoscopes</p>
    <p>No instant predictions</p>

    <a href="#hall">Hall of Fame</a>
  </div>
</div>

<!-- HERO / HALL OF FAME -->
<div class="hero" id="hall">
  <div class="post-card glass" onclick="togglePost()">
    <h3>Hall of Fame</h3>
    <div class="meta" id="postMeta"></div>
    <div class="post-preview" id="postPreview"></div>
    <div class="post-full" id="postFull"></div>
    <div class="read-more" id="readMore">Tap to expand</div>
  </div>
</div>

<!-- ZENO EYE -->
<div id="zeno-eye"></div>

<!-- ZENO CLOUD -->
<div id="zeno-cloud" class="glass">
  <p>
    LagneshMitra,<br><br>
    your index page listing is present.<br><br>
    Do you want to read it?
  </p>
  <button onclick="zenoYes()">Yes</button>
  <button onclick="zenoClose()">Close</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getFirestore, doc, setDoc, updateDoc,
  serverTimestamp, collection, getDocs, increment
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const app = initializeApp({
  apiKey:"AIzaSyCX8yGRJc5AcxSEaaC6AzNLZzxtOCz83Sk",
  authDomain:"lagneshmitra-e57b8.firebaseapp.com",
  projectId:"lagneshmitra-e57b8"
});
const db = getFirestore(app);

window.toggleMenu=()=>menuBox.style.display=
  menuBox.style.display==="block"?"none":"block";

/* ---------- POST TOGGLE ---------- */
let expanded=false, currentPostId=null;

window.togglePost=async()=>{
  if(!currentPostId) return;
  expanded=!expanded;
  postFull.style.display=expanded?"block":"none";
  postPreview.style.display=expanded?"none":"block";
  readMore.innerText=expanded?"Tap to collapse":"Tap to expand";

  if(expanded){
    await updateDoc(doc(db,"posts",currentPostId),{
      views: increment(1)
    });
  }
};

/* ---------- LOAD POST ---------- */
async function loadLatestPost(){
  const snap=await getDocs(collection(db,"posts"));
  let latest=null;
  snap.forEach(d=>{
    const data=d.data();
    if(!latest || (data.updatedAt?.seconds||0)>(latest.updatedAt?.seconds||0)){
      latest={id:d.id,...data};
    }
  });
  if(!latest) return;

  currentPostId=latest.id;
  const full=latest.content||"";
  postPreview.innerText=full.substring(0,300)+(full.length>300?"...":"");
  postFull.innerText=full;

  const hrs=latest.updatedAt?.seconds
    ?Math.floor((Date.now()/1000-latest.updatedAt.seconds)/3600):0;

  postMeta.innerText=`Updated ${hrs} hrs ago • Views ${latest.views||0}`;
}
loadLatestPost();

/* ---------- ZENO ---------- */
const eye=document.getElementById("zeno-eye");
const cloud=document.getElementById("zeno-cloud");

eye.onclick=()=>cloud.style.display="block";
function zenoClose(){cloud.style.display="none"}
function zenoYes(){
  cloud.innerHTML=`
    <p>
      Index Page — Active<br><br>
      • Header: present<br>
      • Dropdown: present<br>
      • Hall of Fame: present<br>
      • Color schema: applied<br><br>
      Observation complete.
    </p>
    <button onclick="zenoClose()">Close</button>
  `;
}
</script>

</body>
</html>
